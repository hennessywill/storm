<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Storm</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-dark.css">
    <link rel="stylesheet" href="stylesheets/custom.css">
    <script src='https://cdn.firebase.com/js/client/2.2.1/firebase.js'></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="javascripts/main.js"></script>
    <script src="javascripts/util.js"></script>
    <script src="javascripts/clock.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  </head>
  <body>
    <div class="container">
      <div id="topbar">
        <span id="goal"></span>
      </div>
      <div id="sidebar">
        <div id="clock">00:00</div>
        <div id="definition" class="stage">1) Definition</div>
        <div id="ideation" class="stage active">2) Ideation</div>
        <div id="discussion" class="stage">3) Discussion</div>
        <div id="decision" class="stage">4) Decision</div>
      </div>
      <div id="main">
        <div id="section-title" class="section-title">Ideation</div>

        <div id="overview">
          Brainstorm as many ideas as you can! When time runs out, all ideas will be shared with the group. Feel free to propose crazy ideas because they will always be anonymous.
        </div>
        <br>

        <form onsubmit="return submitToFirebase(event)">
          <label>Idea</label>
          <input type="text" id="idea1" placeholder="Idea title"><br><br>
          <label>Description</label>
          <textarea id="description1" rows="5" cols="70"></textarea><br><br>

          <label>Idea</label>
          <input type="text" id="idea2" placeholder="Idea title"><br><br>
          <label>Description</label>
          <textarea id="description2" rows="5" cols="70"></textarea><br><br>

          <label>Idea</label>
          <input type="text" id="idea3" placeholder="Idea title"><br><br>
          <label>Description</label>
          <textarea id="description3" rows="5" cols="70"></textarea><br><br>

          <label>Idea</label>
          <input type="text" id="idea4" placeholder="Idea title"><br><br>
          <label>Description</label>
          <textarea id="description4" rows="5" cols="70"></textarea><br><br>

          <label>Idea</label>
          <input type="text" id="idea5" placeholder="Idea title"><br><br>
          <label>Description</label>
          <textarea id="description5" rows="5" cols="70"></textarea><br><br>

          <br><br><p>These ideas will be automatically submitted when the timer hits zero.</p>
        </form>

        <script>
          var key = getFirebaseKey();
          var ref = new Firebase(getSessionUrl(key));
          ref.once("value", function(snapshot) {
            var session = snapshot.val();
            initIdeationClock(session.date, session.time, session.duration);
            $("#goal").html(session.goal);
          }, function (errorObject) {
            console.log("The read failed: " + errorObject.code);
          });

          function submitToFirebase() {
            //event.preventDefault();
            var idea1 = $('#idea1').val();
            var idea2 = $('#idea2').val();
            var idea3 = $('#idea3').val();
            var idea4 = $('#idea4').val();
            var idea5 = $('#idea5').val();
            var description1 = $('#description1').val();
            var description2 = $('#description2').val();
            var description3 = $('#description3').val();
            var description4 = $('#description4').val();
            var description5 = $('#description5').val();

            var key = getFirebaseKey();
            var ref = new Firebase(getIdeaUrl(key));

            ref.push({
              idea1: {title: idea1, description: description1},
              idea2: {title: idea2, description: description2},
              idea3: {title: idea3, description: description3},
              idea4: {title: idea4, description: description4},
              idea5: {title: idea5, description: description5},
            },
            onSubmitToFirebaseComplete);

            return false;
          }

          function onSubmitToFirebaseComplete(error) {
            if (error) {
              alert("Sorry, an error occurred");
            }
            else {
              // redirect to the discussion page
              if (isDeployed()) {
                window.location.replace("http://www.willhennessy.com/storm/discussion?session="+getFirebaseKey());
              } else {
                window.location.replace("/Users/willhennessy/Documents/CS%20598%20-%20Social/storm/discussion.html?creator=1&session="+getFirebaseKey());
              }
            }
          }
        </script>
      </div>
    </div>

    <div class="wrapper">

    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
    
  </body>
</html>
